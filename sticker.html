<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="style.css" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Arapey:ital@0;1&family=Fraunces:ital,opsz,wght@0,9..144,100..900;1,9..144,100..900&family=Instrument+Serif:ital@0;1&display=swap" rel="stylesheet">
    <title>QR Code Sticker Collection</title>
    <script src="https://unpkg.com/html5-qrcode"></script>
    <style>
        @font-face {
            font-family: 'HeaderFont';
            src: url('style/fonts/IFDurerDisplay-PERSONALUSE-Regular.ttf') format('truetype');
            font-weight: normal;
            font-style: normal;
        }
        * {
            box-sizing: border-box;
            margin: 0;
        }
        body, html {
            margin: 0;
            padding: 0;
        }
        body {
                background-image: url("images/background.webp");
                background-position: center;
                background-repeat: repeat;
                background-size: 100%;
                background-attachment: fixed;
            }
        .header {
            padding: 40px;
            text-align: center;
            background: #974438;
            color: #ca7c3a;
            font-size: 60px;
            font-family: 'HeaderFont';
            padding-top: 40px;
        }

        /* collect a sticker */ 
        h2 { 
            color: #974438;
            font-size: 60px;
        }

        h3 {
            font-size: 24px;
            color: #974438;
            margin-bottom: 20px;
            text-align: center;
        }

        .main {
            padding: 20px;
            text-align: center;
            font-family: Fraunces;
        }

        #reader {
            width: 100%; /* Adjust to your preferred width */
            max-width: 400px; /* Limit the size */
            height: 300px; /* Adjust height as needed */
            border: 4px solid #974438;; /* Add border around the camera view */
            border-radius: 15px; /* Optional: rounded corners */
            margin: 20px auto;
        }

       /*------------------------Sticker gallery -----------------------*/
        .gallery {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
            gap: 15px;
            justify-content: center;
            background: #fff8e1; /* Light pastel background */
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0px 5px 15px rgba(0, 0, 0, 0.1);
            width: 75%;
            margin: 0 auto;
        }

        .sticker {
            width: 110px;
            height: 110px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: white;
            border: 3px dashed #ff7b72; /* Dashed border for cute sticker effect */
            border-radius: 15px;
            box-shadow: 3px 3px 8px rgba(0, 0, 0, 0.1);
            transition: transform 0.2s ease-in-out;
        }

        .sticker:hover {
            transform: scale(1.1);
        }

        .sticker img {
            width: 80px;
            height: 80px;
            object-fit: contain;
        }

        
        /*------------------------Scroll Bar-----------------------*/
        ::-webkit-scrollbar {
            width: 20px;
        }
            
        ::-webkit-scrollbar-track {
            box-shadow: inset 0 0 5px grey;
            border-radius: 10px;
        }
            
        ::-webkit-scrollbar-thumb {
            background-color: #ca7c3a;
            border-radius: 10px;
        }
            
        ::-webkit-scrollbar-thumb:hover {
            background-color: #974438;
        }
        /*========================Nav Bar=========================*/
        .nav-bar {
            display: flex;
            flex-flow: row wrap;
            width: 100%;
            height: 90px;
            background-color: #ca7c3a;
            box-shadow: 3px 3px 10px lightslategray;
            align-items: center;
            justify-content: center;
            position: sticky;
            top: 0;
            z-index: 1;
        }
            
        .logo {
            flex: 1;
            font-size: 40px;
            padding: 20px;
            margin-left: 50px;
            font-family: 'HeaderFont', Fraunces;
        }
            
        ul.menu {
            flex: 1;
            display: flex;
            flex-flow: row wrap;
        }

        .menu li {
            flex: 1;
            list-style-type: none;
            font-size: 16px;
            font-family: Fraunces;
            text-align: center;
        }
        .menu li a {
            text-decoration: none;
            color: #000;
            text-transform: uppercase;
            font-size: 25px;
            font-family: Arapey;
        }
            
        .menu li a:hover {
            color: #4a574e;
            text-decoration: underline;
        }
        /*========================Footer=========================*/
        .footer {
                width: 100%;
                height: 100px;
                position: relative;
                display: flex;
                flex-flow: row wrap;
                justify-content: center;
                align-items: center;
                background-color: #4a574e;
                bottom: 0;
            }
        .footer h4 {
            font-family: Fraunces;
            font-weight: normal;
            font-size: 15px;
            margin-bottom: 5px;
            color: #f4f5e5;
        }
        .footer::before {
            position: absolute;
            content: '';
            display: block;
            background-color: #974438(0, 0, 36, 0.80);
            top: 0;
            left: 0;
            bottom: 0;
            right: 0;
        }
        /*========================responsive=========================*/
        @media all and (max-width: 942px) {
            .nav-bar {
                display: flex;
                flex-flow: column wrap;
                justify-content: center;
                align-items: center;
                width: 100%;
                height: auto;
                text-align: center;
                position: static;
            }

            .logo {
                flex: 1;
                font-size: 30px;
                margin: 10px auto;
                font-family: 'HeaderFont', sans-serif;
                color: #FDE02F;
            }

            .nav-bar ul {
                display: none;
            }

            .nav-bar ul li {
                flex: 1;
                margin-bottom: 5px;
                font-size: 14px;
            }
        }

        @media all and (max-width: 708px) {
            .footer{
                width: 100%;
                height: 670px;
                position: relative;
                display: flex;
                flex-flow: column wrap;
                justify-content: center;
                align-items: center;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>View Your Stickers!</h1>
    </div>
    <section class="nav-bar">
        <div class="logo">
            <ul class="menu">
                <li><a href="index.html">Home</a></li>
                <li><a href="dairymarket/dairymarket.html">Dairy Market</a></li>
                <li><a href="downtown/downtown.html">Downtown</a></li>
            </ul>
        </div>
    </section>
    <!-- main page-->
    <section class="main">
        <h2>Collect a Sticker!</h2>
        <p>Scan the QR code on your keychain to unlock a special sticker!</p> 
        <div id="reader"></div>

        <h3>Your Sticker Collection</h3>
        <div class="gallery" id="stickerGallery">
            <!-- Stickers will be displayed here -->
        </div>
    </section>
    <!-- footer-->
    <div class="footer">
        <h4>Copyright KeypInTouch Â© 2025 All rights reserved.</h4>
    </div>

    <script>
        // make an array to hold all the pictures used for the sticker
        const stickerpics = [
            "https://www.google.com/url?sa=i&url=https%3A%2F%2Fwww.dreamstime.com%2Fillustration%2Fmilk-carton.html&psig=AOvVaw3H5wzpbC0gqrJcsZpycRUH&ust=1740388224400000&source=images&cd=vfe&opi=89978449&ved=0CBQQjRxqFwoTCOiA6N252YsDFQAAAAAdAAAAABAE",
            "https://media.istockphoto.com/id/1169326887/vector/cartoon-cute-doodles-hand-drawn-welcome-to-new-york-illustration.jpg?s=612x612&w=0&k=20&c=5oZnCshTwi33tG178SqIQQA6UWp5tmAzNyWrEP9rxnA=",
        ];

        let counter = 0; // Counter to track the sticker to display next

        // use local storage so user wont lose their stickers 
        function collectSticker(stickerId) {
            let stickers = JSON.parse(localStorage.getItem("stickers")) || [];

            // need to check if we already added that sticker 
            if (!stickers.includes(stickerId)) // if we don't already have that sticker, then we add it 
            {
                stickers.push(stickerId);
                localStorage.setItem("stickers", JSON.stringify(stickers));
                alert("New sticker collected!");
            } else {
                alert("You already have this sticker!");
            }

            displayStickers(); // display the sticker 
        }

        // keep all the stickers displayed
        function displayStickers() {
            let stickers = JSON.parse(localStorage.getItem("stickers")) || [];
            let stickerContainer = document.getElementById("stickerGallery");
            stickerContainer.innerHTML = stickers.map(sticker => 
                `<div class="sticker"><img src="${sticker}" alt="Sticker"></div>`
            ).join("");
        }

        // scan the qr code successfully
        function onScanSuccess(decodedText) {
            console.log("Decoded QR Code Text: ", decodedText); 

            // if we're still in the range of given stickers, then move on and add next sticker
            if (counter < stickerpics.length) {
                collectSticker(stickerpics[counter]);
                counter++;
            } else {
                alert("You've collected all the stickers!");
            }
        }

        // actually keeps the camera feature...
        function onScanError(errorMessage) {
            
        }

        // make the qr code scanner part 
        let html5QrcodeScanner = new Html5Qrcode("reader");
        html5QrcodeScanner.start({ facingMode: "environment" }, // which camera should be used
        { 
            fps: 10,
            qrbox: 250 // size of qr code area
        }, onScanSuccess, onScanError);

        // use this to display the stickers overall 
        displayStickers();

    </script>
</body>
</html>
